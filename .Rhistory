pp = mean_omit_na(PP01))
mean_value <- plyr::ddply(cwb, ~ 'C0M530', summarize,
tx = mean_omit_na(TX01),
pp = mean_omit_na(PP01))
View(mean_value)
mean_value <- plyr::ddply(cwb, ~ col(ston,C0M530), summarize,
tx = mean_omit_na(TX01),
pp = mean_omit_na(PP01))
mean_value <- plyr::ddply(cwb, ~ 'C0M530', summarize,
time = '20060101'
tx = mean_omit_na(TX01),
pp = mean_omit_na(PP01))
mean_value <- plyr::ddply(cwb, ~ 'C0M530', summarize,
time = 20060101
tx = mean_omit_na(TX01),
pp = mean_omit_na(PP01))
aggregate(. ~ 'C0M530', data = cwb, FUN = mean_omit_na)
library(aggregate)
aggregate(. ~ stno, data = cwb, FUN = mean_omit_na)
mean_va <- aggregate(. ~ stno, data = cwb, FUN = mean_omit_na)
View(mean_va)
mean_va <- aggregate(stno <= C0M530, data = cwb, FUN = mean_omit_na)
mean_va <- aggregate(.stno <= C0M530, data = cwb, FUN = mean_omit_na)
mean_va <- aggregate(.(stno) <= C0M530, data = cwb, FUN = mean_omit_na)
mean_va <- aggregate(.(stno) <= 'C0M530', data = cwb, FUN = mean_omit_na)
mean_va <- aggregate(.(stno) <= 'C0M530', data = cwb, by= list(cwb$stno), FUN = mean_omit_na)
mean_va <- aggregate('C0M530', data = cwb, by= list(cwb$stno), FUN = mean_omit_na)
## 基礎統計
# 鴛尾花資料集
iris
ir <- iris
# 取得 iris 資料集的摘要
summary(iris)
# 計算
mean(iris$Sepal.Length)
mean(iris$Sepal.Width)
sd(iris$Sepal.Length)
aggregate(iris$Petal.Length, by = list(iris$Species), FUN = mean)
mean_va <- aggregate(cwb$stno, by = list(cwb$timestamp), FUN = mean)
View(mean_value)
View(mean_va)
mean_va <- aggregate(cwb$stno, by = list(cwb$timestamp), FUN = mean_omit_na)
View(mean_va)
mean_va <- aggregate(cwb$stno <= 'C0M530', by = list(cwb$timestamp), FUN = mean_omit_na)
View(mean_va)
mean_va <- aggregate(cwb$stno <= 'C0M530', by = list(cwb$timestamp <= 20060101), FUN = mean_omit_na)
View(mean_va)
cwb[ cwb$stno == C0M530]
cwb[cwb$stno == C0M530]
cwb[cwb$stno == 'C0M530']
C0M530 <- cwb[cwb$stno == 'C0M530']
View(C0M530)
View(C0M530)
data.table::as.IDate(cwb$timestamp)
COM530[, date:= data.table::as.IDate(timestamp)]
C0M530[, date:= data.table::as.IDate(timestamp)]
View(C0M530)
cwb[,timestamp:=as.POSIXct(strptime(yyyymmddhr-1,'%Y%m%d%H'))]
C0M530[, date:= data.table::as.IDate(timestamp)]
C0M530 <- cwb[cwb$stno == 'C0M530']
C0M530[, date:= data.table::as.IDate(timestamp)]
View(C0M530)
C0M530[, date:= as.Date(timestamp)]
View(C0M530)
C0M530[, date:= strptime(timestamp, '%Y-%m-%d')]
View(C0M530)
names(C0M530$timestamp)
format.Date(C0M530$timestamp, '%T')
format.Date(C0M530$timestamp, '%Y-%m-%d')
C0M530[, date:= format.Date(timestamp, '%Y-%m-%d')]
View(C0M530)
mean_va <- aggregate(C0M530$TX01, by = list(C0M530$date), FUN = mean_omit_na)
View(mean_va)
C0M530$TX01
View(mean_va)
mean_va <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = mean_omit_na)
View(mean_va)
setwd('D:/凱/生態資訊/git')
library(data.table)
cwb <- fread('D:/凱/生態資訊/data/raw/200601_auto_hr.txt', skip=74
, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999'))
cwb <- fread('D:/凱/生態資訊/data/raw/200601_auto_hr.txt', skip=74
, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999'))
colnames <- c("stno", "yyyymmddhr","PS01", "TX01", "RH01","WD01","WD02", "PP01",
"SS01")
setnames(cwb,1:9,colnames)
strptime(cwb$yyyymmddhr,'%Y%m%d%H')
cwb[,timestamp:=as.POSIXct(strptime(yyyymmddhr-1,'%Y%m%d%H'))]
View(cwb)
format.Date(C0M530$timestamp, '%Y-%m-%d')
strptime(cwb$yyyymmddhr,'%Y%m%d%H')
cwb[,timestamp:=as.POSIXct(strptime(yyyymmddhr-1,'%Y%m%d%H'))]
C0M530 <- cwb[cwb$stno == 'C0M530']
format.Date(C0M530$timestamp, '%Y-%m-%d')
C0M530[, date:= format.Date(timestamp, '%Y-%m-%d')]
View(cwb)
View(C0M530)
mean_omit_na <- function(x){
x <- as.numeric(x)
return (mean(x, na.rm = T))
}
mean_va <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = mean_omit_na)
View(mean_va)
View(mean_va)
mean_DTM <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = mean_omit_na)
View(C0M530)
View(mean_omit_na)
Max_T <- function(x){
x <- numeric(x)
return(max(x,na.rm = T))
}
min_T <-  function(x){
x <- numeric(x)
return(min(x, na.rm = T))
}
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
length = auto
Max_T(C0M530$TX01)
Max_T(C0M530$TX01)
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = F))
}
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = F))
}
min_T <-  function(x){
x <- numeric(x)
return(min(x, na.rm = F))
}
Max_T(C0M530$TX01)
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
min(5:1, pi)
min(5:1, pi)
min(c(1,3,5), pi)
min(c(1,3,5,'NA'), pi)
min(c(1,3,5,NA), pi)
Max_T <- function(x){
x <- numeric(x)
return(max(x, pi))
}
min_T <-  function(x){
x <- numeric(x)
return(min(x, pi))
}
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T, pi)
library(stats)
Max_T <- function(x){
x <- numeric(x)
return(max(x, pi))
}
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T))
}
min_T <-  function(x){
x <- numeric(x)
return(min(x, na.rm = T))
}
mean_DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
Max_T <- function(x){
x <- numeric(x)
return(max(..., na.rm = F))
}
min_T <-  function(x){
x <- numeric(x)
return(min(..., na.rm = F))
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = Max_T)
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
Max_T <- function(x){
x <- numeric(x)
return(max(..., na.rm = T))
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
View(C0M530)
Max(C0M530$TX01, by = list(C0M530$date), na.rm = T)
max(C0M530$TX01, by = list(C0M530$date), na.rm = T)
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T))
DMaxT <- max(aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T))
##
<
DMaxT <- max(aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T))
DMaxT <- max(aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T))
DMaxT <- max(x <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T),na.rm = T)
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = max(x)))
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T))
}
TP
TP <- c(1, 4, 5, 66, 3, 4 , 'NA', 3)
max(TP)
TP <- c(1, 4, 5, 66, 3, 4 , "NA", 3)
max(TP)
max(TP, na.rm = T)
max(TP, na.rm = F)
TP <- c(1, 4, 5, 66, 3, 4 , 'NA', 3)
max(TP, na.rm = F)
max(TP, na.rm = T)
max(1:10)
max(1:10;"NA", na.rm = T)
max(1:10"NA", na.rm = T)
max(TP, na.rm = T)
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T))
}
Max_T(TP)
return(max(x, na.rm = T, length(x)))
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T, length(x)))
}
Max_T(TP)
return(max(x, na.rm = T, length('auto')))
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T, length('auto')))
}
Max_T(TP)
C0M530[which(C0M530$TX01 == min(C0M530$date)), ]
C0M530[which(C0M530$TX01 == min(C0M530$date)),na.rm = T,  ]
C0M530[which(C0M530$TX01 == min(C0M530$date,na.rm = T)),  ]
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T,))
}
C0M530[which(C0M530$TX01 == min(C0M530$date,na.rm = T)),  ]
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
Max_T <- function(x){
x <- numeric(x)
return(max(x, na.rm = T))
Max_T <- function(x){
x <- numeric(x)
max(x, na.rm = T)
}
min_T <-  function(x){
x <- numeric(x)
min(x, na.rm = T)
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
##
>
Max_T <- function(x){
x <- numeric(x)
max(x, na.rm = T)
}
min_T <-  function(x){
x <- numeric(x)
min(x, na.rm = T)
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
## list.files
## 題目：
### 1.計算C0M530(奮起湖)從2006~2015十年的
###   日均溫、日低溫、日高溫、月均溫、月累積降水
#### 2.計算最暖月每日最高均溫
##### 3.計算最冷月每日最低均溫
##  前置作業
{
setwd('D:/凱/生態資訊/git')
# 輸入資料 (tab 可顯示list 路徑)
library(data.table)
cwb <- fread('D:/凱/生態資訊/data/raw/200601_auto_hr.txt', skip=74
, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999'))
# 設定欄位名稱(colnames <- c(固定格式)
#              setnames(目標,欄位,colnames)
colnames <- c("stno", "yyyymmddhr","PS01", "TX01", "RH01","WD01","WD02", "PP01",
"SS01")
setnames(cwb,1:9,colnames)
# 時間格式化(strptime(目標,'格式'))
# 建立新欄位 cwb[, timestamps:=as.POSIXct(strptime(yyyymmddhr,'%Y%m%d%H'))]
strptime(cwb$yyyymmddhr,'%Y%m%d%H')
cwb[,timestamp:=as.POSIXct(strptime(yyyymmddhr-1,'%Y%m%d%H'))]
}
## 開始aggregate(表示式,資料集,函數)
{
# 先抓出([ == ])目標測站'C0M530'資料，並整理時間標記(format.Date)去除hr
C0M530 <- cwb[cwb$stno == 'C0M530']
format.Date(C0M530$timestamp, '%Y-%m-%d')
C0M530[, date:= format.Date(timestamp, '%Y-%m-%d')]
# 設計funtion,計算mean(注意目前資料讀取為文字檔，需轉換成數值(as.numeric())，
#                                                   並去除'NA' = na.rm = TRUE)
mean_omit_na <- function(x){
x <- as.numeric(x)
return (mean(x, na.rm = T))
}
## DEMO: aggregate(iris$Petal.Length, by = list(iris$Species), FUN = mean)
}
### 2006年每日日均溫daliy tmper (DTM)
mean_DTM <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date),
FUN = mean_omit_na)
### 2006年每日最低溫、最高溫Daliy Max/ min tmper (DMaxT/DminT)
# 寫funtion 判定最大最小值
library(stats)
Max_T <- function(x){
x <- numeric(x)
max(x, na.rm = T)
}
min_T <-  function(x){
x <- numeric(x)
min(x, na.rm = T)
}
## use it
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
##
>
Max_T <- function(x){
x <- numeric(x)
max(..., na.rm = F)
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
Max_T <- function(x){
x <- numeric(x)
max(..., na.rm = FALSE)
}
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
DMaxT <- aggregate(as.numeric(C0M530$TX01), by = list(C0M530$date), FUN = Max_T)
View(C0M530)
max(C0M530$TX01)
max(C0M530$TX01, na.rm = TRUE)
DMaxT <- aggregate(C0M530$TX01, by = list(C0M530$date), FUN = max)
View(DMaxT)
View(DMaxT)
Max_T <- function(x){
max(x, na.rm = TRUE)
}
DMaxT <- aggregate(C0M530$TX01, by = list(C0M530$date), FUN = Max_T)
View(DMaxT)
min_T <-  function(x){
min(x, na.rm = TRUE)
}
DminT <- aggregate(C0M530$TX01, by = list(C0M530$date), FUN = min_T)
View(DminT)
list.files(path = 'D:/凱/生態資訊/data/raw/',
skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999') )
list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto+.*txt"
skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999') )
open_fileslist.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto+.*txt"
<
##  前置作業
<
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto"
skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999'))
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto",
skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999'))
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
open_files
all_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
dir(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
listOfDataframes <- lapply(paste0(2006:2015, ".txt"), fread)
listOfDataframes <- lapply(paste0("200601_auto_hr":"201512_auto_hr", ".txt"), fread)
listOfDataframes <- lapply(paste0("200601_auto_hr:201512_auto_hr", ".txt"), fread)
listOfDataframes <- lapply(paste0(200601:201512, "_auto_hr.txt"), fread)
listOfDataframes <- lapply("auto", fread('D:/凱/生態資訊/data/raw/',skip=74
,na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
open_files
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
listOfDataframes <- lapply(open_files, fread('D:/凱/生態資訊/data/raw/',skip=74
,na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
listOfDataframes <- lapply(open_files, fread(, skip=74, na.strings =
c('-9991','-9995','-9996','-9997','-9998','-9999')))
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto", skip=74, na.strings =
c('-9991','-9995','-9996','-9997','-9998','-9999'))
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
listOfDataframes <- lapply(open_files, fread)
open_files
listOfDataframes <- lapply(open_files, fread)
y
open_files <- funtion(x){
for (x in names)
for (y in names)
x <- c(06:15)
y <- c(01:12)
names <- "20xy_auto_hr.txt"
}
open_files <- funtion(x){
for (x in names)
for (y in names)
x <- c(06:15)
y <- c(01:12)
names <- "20xy_auto_hr.txt"
}
open_files <- funtion(x){
for (x in names, y in names ){
x <- c(06:15)
y <- c(01:12)}
names <- "20xy_auto_hr.txt"
}
open_files <- funtion(x){
for (x in names){
x <- c(06:15)}
names <- "20xy_auto_hr.txt"
}
open_files <- funtion(x){
for (x in names) {
x <- c(06:15)
names <- "20xy_auto_hr.txt"
}
}
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
listOfDataframes <- lapply(paste0(200601:201512, "_auto_hr.txt"), fread)
listOfDataframes <- lapply(paste0(200601:201512, "_auto_hr.txt"), fread)
listOfDataframes <- lapply(paste0(200601:201512, "_auto_hr.txt"), fread('D:/凱/生態資訊/data/raw/'))
listOfDataframes <- lapply('D:/凱/生態資訊/data/raw/', fread)
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
listOfDataframes <- lapply(open_files, fread)
listOfDataframes <- lapply(open_files, fread(open_files))
open_files
names <- c(open_files())
d <- lapply (names, fread(name))
names <- c(open_files(x))
d <- lapply (names, fread(name))
names <- c(open_files)
d <- lapply (names, fread(name))
names <- c(open_files)
d <- lapply (names, fread(name))
d <- lapply (open_files, fread(name))
d <- lapply (open_files, fread(open_files))
open_files <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
d <- lapply (open_files, fread('D:/凱/生態資訊/data/raw/'))
d <- lapply (open_files, list.files)
d
x <-list("D:/凱/生態資訊/data/raw/")
x <-list('D:/凱/生態資訊/data/raw/')
x
d <- lapply (x, fread)
all_date <- fread(open_files)
list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto")
all_data <- lapply (list.files, fread)
list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
all_data <- lapply (data_list, fread)
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
data_list
all_data <- lapply (list, fread)
all_data <- lapply (list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr"), fread)
all_data <- lapply ( "D:/凱/生態資訊/data/raw/" , fread)
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
names <- substr(data_list,1,120)
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/",paste(i,".txt",sep=""))
}
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/",paste(i,".txt",sep=""))
assign(i, fread(filepath, skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
filepath <- file.path("D:/凱/生態資訊/data/raw/")
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
names <- substr(data_list,1,120)
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/")
assign(i, fread('D:/凱/生態資訊/data/raw/', skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
assign(i, fread( path ="..." , skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/")
assign(i, read.delim( filepath, skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/'names'.txt")
assign(i, read.delim( filepath, skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
for (i in names) {
filepath <- file.path(data_list(names))
assign(i, read.delim( filepath, skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
for (i in names) {
filepath <- file.path(data_list)
assign(i, read.delim( filepath, skip = 74, na.strings = c('-9991','-9995','-9996','-9997','-9998','-9999')))
}
for (i in names) {
filepath <- file.path("D:/凱/生態資訊/data/raw/")
assign(i, read.delim(filepath))
}
for (i in names) {
filepath <- file.path('D:/凱/生態資訊/data/raw/')
assign(i, read.delim(filepath))
}
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
names <- substr(data_list,1,120)
for (i in names) {
filepath <- file.path('D:/凱/生態資訊/data/raw/')
assign(i, read.delim(filepath))
}
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
substr(data_list,1,120)
for (i in names) {
filepath <- file.path('D:/凱/生態資訊/data/raw/')
assign(i, read.delim(filepath))
}
filelist <- lappy(data_list, fread)
filelist <- lapply(data_list, fread)
data_list <- list.files(path = "D:/凱/生態資訊/data/raw/" , pattern = "auto_hr")
substr(data_list,1,120)
filelist <- lapply(data_list, fread)
